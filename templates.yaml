# Waze Integration
- sensor:
    - name: "Average Travel Time S"
      unit_of_measurement: "min"
      state: >
        {% set today_0 = states('sensor.s') | float %}
        {% set today_1 = states('sensor.s1') | float %}
        {% set today_2 = states('sensor.s2') | float %}
        {% set today_3 = states('sensor.s3') | float %}
        {% set today_4 = states('sensor.s4') | float %}
        {% set today_5 = states('sensor.s5') | float %}
        {% set today_6 = states('sensor.s6') | float %}
        {% set today_7 = states('sensor.s7') | float %}
        {{ ((today_0 + today_1 + today_2 + today_3 + today_4 + today_5 + today_6 + today_7) / 8) | round(1, default=0) }}

- sensor:
    - name: "Average Travel Time P"
      unit_of_measurement: "min"
      state: >
        {% set today_P0 = states('sensor.p') | float %}
        {% set today_P1 = states('sensor.p1') | float %}
        {% set today_P2 = states('sensor.p2') | float %}
        {% set today_P3 = states('sensor.p3') | float %}
        {% set today_P4 = states('sensor.p4') | float %}
        {% set today_P5 = states('sensor.p5') | float %}
        {% set today_P6 = states('sensor.p6') | float %}
        {% set today_P7 = states('sensor.p7') | float %}
        {{ ((today_P0 + today_P1 + today_P2 + today_P3 + today_P4 + today_P5 + today_P6 + today_P7) / 8) | round(1, default=0) }}

# Sensibo
- sensor:
    - name: Sensibo Humidity
      state: "{{ state_attr('climate.ofir_a_c', 'current_humidity') }}"
      unit_of_measurement: "%"
      icon: mdi:water-percent

- sensor:
    - name: Sensibo Tempature
      state: "{{ state_attr('climate.ofir_a_c', 'current_temperature') }}"
      unit_of_measurement: "Â°C"
      icon: mdi:thermometer

# Counters
- sensor:
    - name: chromecastcounter
      state: >-
        {% set group = expand('group.chromecast') %}
        {{ group | count }}/{{ group | selectattr('state','eq','on') | list | count }}
- sensor:
    - name: camerascounter
      state: >-
        {% set group = expand('group.cameras') %}
        {{ group | count }}/{{ group | list | count }}
- sensor:
    - name: lightscounter
      state: >-
        {% set group = expand('group.lights') %}
        {{ group | count }}/{{ group | selectattr('state','eq','on') | list | count }}
- sensor:
    - name: rf433counter
      state: >-
        {% set group = expand('group.rf433') %}
        {{ group | count }}/{{ group | list | count }}
- sensor:
    - name: tempcounter
      state: >-
        {% set group = expand('group.temp') %}
        {{ group | count }}/{{ group | list | count }}

# Online States
- sensor:
    - name: Zigbee Online
      state: >
        {{ iif(is_state('binary_sensor.zigbee2mqtt_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.zigbee2mqtt_running') not in ['unavailable', 'unknown'] }}
    - name: MQTT Online
      state: >
        {{ iif(is_state('binary_sensor.mosquitto_broker_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.mosquitto_broker_running') not in ['unavailable', 'unknown'] }}
    - name: Uptime Kuma Online
      state: >
        {{ iif(is_state('binary_sensor.uptime_kuma_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.uptime_kuma_running') not in ['unavailable', 'unknown'] }}
    - name: Google Drive Online
      state: >
        {{ iif(is_state('binary_sensor.home_assistant_google_drive_backup_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.home_assistant_google_drive_backup_running') not in ['unavailable', 'unknown'] }}
    - name: Plex Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_plex', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_plex') not in ['unavailable', 'unknown'] }}
    - name: Tautulli Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_tautulli', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_tautulli') not in ['unavailable', 'unknown'] }}
    - name: Ubuntu Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_home_assistant_main', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_home_assistant_main') not in ['unavailable', 'unknown'] }}
    - name: qBitTorrent Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_qbittorrent', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_qbittorrent') not in ['unavailable', 'unknown'] }}
    - name: Radarr Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_radarr', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_radarr') not in ['unavailable', 'unknown'] }}
    - name: Sonarr Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_sonarr', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_sonarr') not in ['unavailable', 'unknown'] }}
    - name: Ombi Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_ombi', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_ombi') not in ['unavailable', 'unknown'] }}
    - name: Trakt Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_trakt', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_trakt') not in ['unavailable', 'unknown'] }}
    - name: Prowlarr Online
      state: >
        {{ iif(is_state('sensor.uptimekuma_prowlarr', 'up'), 'Online', 'Offline') }}
      availability: >
        {{ states('sensor.uptimekuma_prowlarr') not in ['unavailable', 'unknown'] }}
