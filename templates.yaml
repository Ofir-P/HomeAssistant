- sensor:
    - name: "Average Travel Time S"
      unit_of_measurement: "min"
      state: >
        {% set today_0 = states('sensor.s') | float %}
        {% set today_1 = states('sensor.s1') | float %}
        {% set today_2 = states('sensor.s2') | float %}
        {% set today_3 = states('sensor.s3') | float %}
        {% set today_4 = states('sensor.s4') | float %}
        {% set today_5 = states('sensor.s5') | float %}
        {% set today_6 = states('sensor.s6') | float %}
        {% set today_7 = states('sensor.s7') | float %}
        {{ ((today_0 + today_1 + today_2 + today_3 + today_4 + today_5 + today_6 + today_7) / 8) | round(1, default=0) }}

- sensor:
    - name: "Average Travel Time P"
      unit_of_measurement: "min"
      state: >
        {% set today_P0 = states('sensor.p') | float %}
        {% set today_P1 = states('sensor.p1') | float %}
        {% set today_P2 = states('sensor.p2') | float %}
        {% set today_P3 = states('sensor.p3') | float %}
        {% set today_P4 = states('sensor.p4') | float %}
        {% set today_P5 = states('sensor.p5') | float %}
        {% set today_P6 = states('sensor.p6') | float %}
        {% set today_P7 = states('sensor.p7') | float %}
        {{ ((today_P0 + today_P1 + today_P2 + today_P3 + today_P4 + today_P5 + today_P6 + today_P7) / 8) | round(1, default=0) }}

- sensor:
    - name: Sensibo_Humidity
      state: "{{ state_attr('climate.ofir_a_c', 'current_humidity') }}"
      unit_of_measurement: "%"
      icon: mdi:water-percent

- sensor:
    - name: cast group
      state: >-
        {{ expand(state_attr('group.chromecast', 'entity_id') )
          | selectattr('state', 'eq', 'on') 
          | list 
          | count
        }}

- sensor:
    - name: ac_counter
      state: >-
        {{ expand(state_attr('group.ac_counter', 'entity_id') )
          | selectattr('state', 'eq', 'on') 
          | list 
          | count
        }}

- sensor:
    - name: Zigbee Online
      state: >
        {{ iif(is_state('binary_sensor.zigbee2mqtt_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.zigbee2mqtt_running') not in ['unavailable', 'unknown'] }}
    - name: MQTT Online
      state: >
        {{ iif(is_state('binary_sensor.mosquitto_broker_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.mosquitto_broker_running') not in ['unavailable', 'unknown'] }}
    - name: Cloudflare Online
      state: >
        {{ iif(is_state('binary_sensor.cloudflared_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.cloudflared_running') not in ['unavailable', 'unknown'] }}
    - name: Google Drive Online
      state: >
        {{ iif(is_state('binary_sensor.home_assistant_google_drive_backup_running', 'on'), 'Online', 'Offline') }}
      availability: >
        {{ states('binary_sensor.home_assistant_google_drive_backup_running') not in ['unavailable', 'unknown'] }}
